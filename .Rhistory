---
```{r global_options, include=FALSE}
knitr::opts_chunk$set(fig.width = 10, fig.height = 5,
echo = FALSE, warning = FALSE, message = FALSE)
```
```{r}
library(quantmod)
library(Quandl)
library(forecast)
library(ggplot2)
library(tseries)
library(xts)
#library(gridExtra)
library(lmtest)
#library(knitr)
```
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
# Вариант 5
## 1
```{r}
autoplot(alcohol, main = "Объем рынка алкогольных напитков, %") +
labs(x = "Год", y = "%", caption = "Добыто на FRED")
```
autoarima <- auto.arima(alcohol)
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
autoarima <- auto.arima(alcohol)
autoplot(autoarima)
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
autoarima <- auto.arima(alcohol)
autoplot(forecast(autoarima, h = 8))
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
t1 <- adf.test(alcohol)
autolot(t1)
autoarima <- auto.arima(alcohol)
autoplot(forecast(autoarima, h = 8))
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
t1 <- adf.test(alcohol)
autolot(t1)
autoarima <- auto.arima(alcohol)
autoplot(forecast(autoarima, h = 8))
```{r echo = TRUE, results='hide'}
# Datasets
getSymbols.FRED("S4248SM144NCEN", env = globalenv())
alcohol <- S4248SM144NCEN
```
t1 <- adf.test(alcohol)
autolot(t1)
t1 <- adf.test(alcohol)
autoplot(t1)
Acf(alcohol)
Pacf(alcohol)
diff_alc <- diff(alcohol, differences = 1)
Acf(diff_alc)
autoarima <- auto.arima(diff_alc seasonal = True)
autoplot(forecast(autoarima, h = 8))
autoarima <- auto.arima(diff_alc, seasonal = TRUE)
autoplot(forecast(autoarima, h = 8))
autoplot(diff_alc)
Acf(diff_alc)
Pacf(diff_alc)
fit <- auto.arima(diff_alc)
fit
fit <- auto.arima(diff_alc, seasonal = TRUE)
fit
fit <- auto.arima(alcohol, seasonal = TRUE)
fit
Acf(diff_alc)
Pacf(diff_alc)
fit <- auto.arima(alcohol, seasonal = TRUE)
fit
fit_my <- Arima(order=c(1, 1, 2), seasonal = c(2, 0, 1))
forecast(fit_my, h = 10)
fit_my <- Arima(order=c(1, 1, 2), seasonal = c(2, 0, 1))
forecast(fit_my, h = 10)
fit_my = Arima(order=c(1, 1, 2), seasonal = c(2, 0, 1))
plot <- forecast(fit_my, h = 10)
plot(plot)
Acf(alcohol)
Pacf(alcohol)
diff_alc <- diff(alcohol, differences = 1)
Acf(diff_alc)
Pacf(diff_alc)
fit <- auto.arima(alcohol, seasonal = TRUE)
fit
fit_my = Arima(order=c(1, 1, 2), seasonal = c(2, 0, 1))
plot <- forecast(fit_my, h = 10)
plot(plot)
tsdisplay(plot)
tsplot(plot)
Acf(alcohol)
Pacf(alcohol)
diff_alc <- diff(alcohol, differences = 1)
Acf(diff_alc)
Pacf(diff_alc)
fit = auto.arima(alcohol, seasonal = TRUE)
tsplot <- forecast(fit, h = 20)
fit <- ets(alcohol)
plot(forecast(fit))
my_fit <- ets(alcohol, model = "AAA")
plot(forecast(my_fit))
my_fit <- ets(alcohol, model = "AAN")
plot(forecast(my_fit))
fit = auto.arima(alcohol)
tsplot <- forecast(fit, h = 20)
fit_my = Arima(order=c(1, 1, 2))
plot <- forecast(fit_my, h = 10)
fit = auto.arima(alcohol)
tsplot <- forecast(fit, h = 20)
fit_my = Arima(alcohol, order=c(1, 1, 2))
plot <- forecast(fit_my, h = 10)
plot(tsplot)
plot(plot)
fit_my = Arima(alcohol, order=c(1, 1, 2))
fit_my
plot <- forecast(fit_my, h = 10)
plot(plot)
#autoplot(diff_alc)
#autoarima <- auto.arima(diff_alc, seasonal = TRUE)
fit_my
fit
fit_my = Arima(alcohol, order=c(1, 1, 3))
fit_my
fit_my = Arima(alcohol, order=c(1, 1, 3), seasonal = c(2, 0, 0))
fit_my
ggseasonplot(alcohol)
ggseasonplot(x = alcohol)
diff_alc <- diff(alcohol, differences = 1)
Acf(diff_alc)
plot(alcohol)
Pacf(diff_alc)
fit = auto.arima(alcohol)
fit
tsplot <- forecast(fit, h = 20)
plot(tsplot)
plot(alcohol)
my_fit <- ets(alcohol, model = "AAN")
plot(my_fit)
plot(forecast(my_fit))
my_fit <- ets(alcohol, model = "AAN")
autoplot(my_fit)
plot(forecast(my_fit))
my_fit <- ets(alcohol, model = "AAA")
autoplot(my_fit)
my_fit <- ets(alcohol, model = "MAA")
autoplot(my_fit)
my_fit <- ets(alcohol, model = "MAN")
autoplot(my_fit)
plot(forecast(my_fit))
Acf(alcohol)
par(mfrow = c(1,1))
```{r}
alcohol
alcohol <- ts(alcohol, start = c(1992, 1), frequency = 12)
autoplot(alcohol)
alcohol <- ts(alcohol, start = c(1992, 1), frequency = 12)
autoplot(alcohol)
tsdisplay(alcohol)
diff_alc <- diff(alcohol, differences = 1)
Acf(diff_alc)
Pacf(diff_alc)
tsdisplay(diff_alc)
fit_my = Arima(alcohol, order=c(1, 1, 2), seasonal = c(2, 1, 0))
fit_my
fit = auto.arima(alcohol, seasonal = TRUE)
fit
fit_my = Arima(alcohol, order=c(1, 1, 2), seasonal = c(2, 1, 1))
fit_my
plot <- forecast(fit_my, h = 10)
plot(plot)
my_fit <- ets(alcohol, model = "MAA")
autoplot(my_fit)
plot(forecast(my_fit))
fit_ets <- ets(alcohol)
fit_ets
plot(forecast(fit_ets))
my_fit <- ets(alcohol, model = "MAA")
my_fit
plot(forecast(my_fit))
fit_arima = Arima(alcohol, order=c(1, 1, 2), seasonal = c(2, 1, 1))
fit_arima
plot <- forecast(fit_arima, h = 10)
plot(plot)
train <- head(alcohol, length(alcohol) - 12)
test <- tail(alcohol, 12)
fit_arima = Arima(train, order=c(1, 1, 2), seasonal = c(2, 1, 1))
fit_arima
fit_arima = Arima(train, order=c(1, 1, 2), seasonal = c(2, 1, 1))
fit_arima = Arima(alcohol, order=c(1, 1, 2), seasonal = c(2, 1, 1))
fit_arima = Arima(train, order=c(1, 1, 2), seasonal = c(2, 1, 0))
fit_arima
plot <- forecast(fit_arima, h = 12)
plot(plot)
accuracy(plot, test)
fit = auto.arima(alcohol, seasonal = TRUE)
fit
fcast2 <- forecast(fit, h = 20)
accuracy(fcast1, test)
accuracy(fcast2, test)
accuracy(fcast1, test)
fcast1 <- forecast(fit_arima, h = 12)
accuracy(fcast1, test)
accuracy(fcast2, test)
fcast2 <- forecast(auto.arima(alcohol, seasonal = TRUE), h = 12)
accuracy(fcast2, test)
fcast2 <- forecast(auto.arima(train, seasonal = TRUE), h = 12)
accuracy(fcast2, test)
accuracy(fcast1, test)
autoplot(fcast1)
autoplot(fcast2)
fit_ets <- ets(train)
fit_ets
autoplot(forecast(fit_ets))
fit_ets <- ets(train)
fit_ets
fcast3 <- forecast(fit_ets)
accuracy(fcast3, test)
my_fit <- ets(train, model = "MAA")
fcast4 <- forecast(my_fit))
accuracy(fcast4, test)
my_fit <- ets(train, model = "MAA")
fcast4 <- forecast(my_fit)
accuracy(fcast4, test)
accuracy(fcast3, test)
autoplot(fcast3)
autoplot(fcast4)
